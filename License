# **5. src/llm/gemini_client.py**

import os
import requests

GEMINI_API_KEY = os.getenv("")
GEMINI_BASE = os.getenv("GEMINI_BASE", "https://api.generativelanguage.googleapis.com/v1beta2")

class GeminiClient:
    def __init__(self, api_key=None):
        self.api_key = api_key or GEMINI_API_KEY

    def generate(self, prompt: str, max_tokens: int = 512, temperature: float = 0.2):
        url = f"{GEMINI_BASE}/models/text-bison-001:generate"
        payload = {
            "prompt": {"text": prompt},
            "maxOutputTokens": max_tokens,
            "temperature": temperature
        }
        headers = {
            "Content-Type": "application/json",
            "Authorization": f"Bearer {self.api_key}"
        }
        r = requests.post(url, json=payload, headers=headers, timeout=30)
        r.raise_for_status()
        data = r.json()
        choices = data.get("candidates", [])
        if choices:
            return choices[0].get("content", "").strip()
        return data.get("output", {}).get("text", "")
